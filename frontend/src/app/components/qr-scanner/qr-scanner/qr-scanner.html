<div class="min-h-screen bg-gradient-to-br from-slate-950 via-emerald-950 to-black flex items-center justify-center p-6">
  <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
    <div class="absolute top-0 left-0 w-96 h-96 bg-emerald-700 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob"></div>
    <div class="absolute bottom-0 right-0 w-96 h-96 bg-lime-600 rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-2000"></div>
  </div>

  <div class="w-full max-w-lg">
    <div class="backdrop-blur-2xl bg-white/10 border border-white/20 rounded-3xl shadow-2xl overflow-hidden">
      <div class="text-center py-10 bg-gradient-to-r from-emerald-600/20 to-teal-600/20 border-b border-white/10">
        <h1 class="text-6xl font-black bg-clip-text text-transparent bg-gradient-to-r from-emerald-400 to-lime-400">
          Scan QR Code
        </h1>
        <p class="text-xl text-gray-300 mt-4">Verify authenticity on the blockchain</p>
      </div>

      <!-- Live Scanner -->
      <div *ngIf="isScanning && !usingFileUpload" class="relative">
        <zxing-scanner
          [formats]="formats"
          (scanSuccess)="onScanSuccess($event)"
          (scanError)="onScanError($event)"
          (permissionResponse)="onPermission($event)"
          (camerasFound)="onCamerasFound($event)"
          [torch]="torchEnabled"
          class="w-full block rounded-2xl overflow-hidden border-8 border-emerald-500/50 shadow-2xl">
        </zxing-scanner>

        <div class="absolute bottom-8 left-1/2 -translate-x-1/2" *ngIf="hasTorch">
          <button (click)="torchEnabled = !torchEnabled"
                  class="group relative bg-gradient-to-r from-yellow-400 to-amber-500 hover:from-yellow-300 hover:to-amber-400 text-black font-black text-xl py-5 px-12 rounded-full shadow-2xl transform hover:scale-110 transition-all duration-300 flex items-center gap-4">
            <div class="absolute inset-0 rounded-full bg-white/40 blur-xl group-hover:blur-2xl transition"></div>
            <svg class="w-8 h-8 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                    d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0114 16.5a3.374 3.374 0 01-2.667 3.293l-.548-.547z" />
            </svg>
            <span class="relative z-10 font-bold">Torch {{ torchEnabled ? 'ON' : 'OFF' }}</span>
          </button>
        </div>
      </div>

      <!-- File Upload -->
      <div *ngIf="!isScanning || usingFileUpload" class="p-12 text-center space-y-10">
        <p class="text-2xl text-gray-300 font-medium">Upload a photo of the QR code</p>
        <label class="cursor-pointer inline-block">
          <input type="file" accept="image/*" (change)="onFileSelected($event)" class="hidden">
          <div class="bg-gradient-to-r from-emerald-500 via-lime-500 to-emerald-600 hover:from-emerald-600 hover:via-lime-600 hover:to-emerald-700 text-white font-black text-3xl py-10 px-20 rounded-3xl shadow-2xl transform hover:scale-105 transition-all duration-300 inline-block">
            Upload Photo
          </div>
        </label>
        <div *ngIf="uploadedImageUrl" class="space-y-6">
          <img [src]="uploadedImageUrl" class="w-full max-w-md mx-auto rounded-3xl shadow-2xl border-8 border-emerald-500/50">
          <p class="text-2xl font-bold text-emerald-400 animate-pulse">Scanning image...</p>
        </div>
      </div>

      <!-- Success State — FIXED -->
      <div *ngIf="scanResult && !isScanning" class="text-center py-24 px-12 space-y-10">
        <div class="text-9xl animate-bounce">Verified</div>
        <h2 class="text-5xl font-black text-emerald-400">QR Verified!</h2>
        <p class="text-xl text-gray-300">This product is 100% authentic on the blockchain</p>
        <button (click)="restart()"
                class="bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white font-black text-2xl py-7 px-20 rounded-full shadow-2xl transform hover:scale-110 transition">
          Scan Another
        </button>
      </div>

      <div class="text-center py-8 border-t border-white/10">
        <p class="text-gray-400 text-sm">Point camera at QR code • Supports photos • End-to-end encrypted</p>
      </div>
    </div>
  </div>
</div>